# MCP-Blink-memory

Modular, audit-ready memory system combining knowledge graph structure, semantic embeddings, auto tagging, and root identity to support agentic workflows.

## Features
- File-backed vector store with `/upsert`, `/query`, `/doc`, `/stats`, and collection management endpoints.
- Model Context Protocol (MCP) bridge for ChatGPT Developer Mode integration.
- Lightweight text-similarity search with cosine scoring and metadata sanitisation.
- Hardened defaults: input validation, payload limits, and safe collection naming.

## Quick start
1. Install Node.js 18+.
2. Install dependencies and start the API:
   ```bash
   npm install
   npm run dev
   ```
3. The memory server listens on `http://0.0.0.0:3000` by default. Override with `HOST`/`PORT` environment variables if required.

### REST endpoints
| Method | Path | Description |
| --- | --- | --- |
| `POST` | `/upsert` | Insert or update memory items. Body requires `{ collection, items[] }`. |
| `POST` | `/query` | Text similarity search. Body requires `{ collection, query, k? }`. |
| `GET` | `/doc` | Fetch a single document by `collection` and `id`. |
| `GET` | `/stats` | Return aggregate statistics for a collection. |
| `GET` | `/collections` | List available collections. |
| `DELETE` | `/collections/:name` | Remove a stored collection. |

### Model Context Protocol bridge
1. Create and activate a Python 3.11 virtual environment.
2. Install bridge dependencies:
   ```bash
   pip install -r requirements.txt
   ```
3. Start the server while the Node API is running:
   ```bash
   python -m mcp.server
   ```
4. In ChatGPT Developer Mode, register the MCP server using the manifest generated by `fastmcp`. The `MEMORY_URL` environment variable points the bridge to the Node API.

## Security notes
- For local-only development set `HOST=127.0.0.1` before starting the Node server to avoid exposing the API on all interfaces.
- JSON payloads are limited to 1 MiB. Individual document bodies over 50 KB and queries over 5 KB are rejected.
- Only plain-text content should be stored; binary payloads are filtered out by validation and not supported by the vector store.
- Collection names and metadata keys are normalised to prevent path traversal and prototype pollution.

## Repository layout
```
.
├── config/                 # Access policy
├── docs/                   # Audit log, changelog, historical notes
├── mcp/                    # MCP bridge
├── memory/                 # Local storage for vector collections
├── modules/                # Future modular services (graph, embedding, tagging)
├── src/                    # Node.js REST API implementation
└── requirements.txt        # MCP bridge dependencies
```

## Developer workflow
- Update `docs/changelog.md` and `docs/audit_log.md` alongside code changes where relevant.
- Keep the memory files under `memory/` under version control for reproducible demos; regenerate them if schema changes.
- Run the CI workflow or `npm run test` (when available) before submitting pull requests.
